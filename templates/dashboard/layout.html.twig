<html lang="fr">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" href="logo.webp"/>

		<title>
			{{ block('title') }}
		</title>
		<!-- Tailwind -->
		{% block stylesheets %}
			{{ encore_entry_link_tags('app') }}
		{% endblock %}
		{% block javascripts %}
			{{ encore_entry_script_tags('app') }}
		{% endblock %}
		<!-- Heroicons -->
		 <script src="https://unpkg.com/feather-icons"></script>
	</head>

	<body class="bg-gray-100">

		<div
			class="flex">

			<!-- SIDEBAR -->
			<aside id="sidebar" class="w-64 bg-white h-screen shadow-md fixed z-30 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out">
				<div class="p-6 border-b flex items-center justify-between">
					<h1 class="text-xl font-bold flex items-center gap-2">
						<span class="bg-blue-600 text-white px-2 py-1 rounded-lg">TF</span>
						TaskFlow
					</h1>
					<!-- Bouton fermer sur mobile -->
					<button id="closeSidebar" class="lg:hidden text-gray-600 hover:text-gray-900">
						<i data-feather="x"></i>
					</button>
				</div>

				<nav class="p-4">
					<a class="flex items-center gap-3 p-3 {{ is_current_route('app_dashboard') ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100 text-gray-700' }} rounded-lg  font-medium mb-2" href="{{ path('app_dashboard') }}">
						<i data-feather="grid"></i>
						Dashboard
					</a>

					<a class="flex items-center gap-3 p-3 {{ is_current_route(['app_task', 'app_add_task', 'app_edit_task', 'app_delete_task'] ) ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100 text-gray-700' }} rounded-lg  mb-2" href="{{ path('app_task') }}">
						<i data-feather="shopping-cart"></i>
						Tâches
					</a>
				</nav>
			</aside>

			<!-- Overlay pour mobile -->
			<div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden lg:hidden"></div>

			<!-- MAIN CONTENT -->
			<main
				class="lg:ml-64 w-full p-4 md:p-6">

				<!-- HEADER -->
				<header class="flex items-center justify-between mb-6">
					<div
						class="flex items-center gap-3">
						<!-- Bouton menu burger sur mobile -->
						<button id="menuToggle" class="lg:hidden p-2 hover:bg-gray-200 rounded-lg">
							<i data-feather="menu"></i>
						</button>
						<h2 class="text-xl md:text-2xl font-bold">Dashboard</h2>
					</div>

					<div class="flex items-center gap-2 md:gap-4">
						<a href="{{ path('app_logout') }}" class="p-2 bg-gray-200 hover:bg-blue-400 hover:text-white rounded-full cursor-pointer" onclick="return confirm('Voulez-vous vraiment vous déconnecter ?');">
							<i data-feather="log-out" class="w-4 h-4"></i>
						</a>
						<span class="hidden sm:block p-2 text-sm md:text-base">
							{{ app.user.email() }}
						</span>
					</div>
				</header>

				<!-- CONTENT -->
				{{ block('content') }}


			</main>

		</div>

		<!-- Script pour le menu mobile -->
		 <script>
							document.addEventListener('DOMContentLoaded', function() {
								// Initialiser les icônes Feather
								feather.replace();

								const menuToggle = document.getElementById('menuToggle');
								const closeSidebar = document.getElementById('closeSidebar');
								const sidebar = document.getElementById('sidebar');
								const overlay = document.getElementById('overlay');

								// Fonction pour ouvrir le menu
								function openSidebar() {
									sidebar.classList.remove('-translate-x-full');
									overlay.classList.remove('hidden');
									document.body.style.overflow = 'hidden';
								}

								// Fonction pour fermer le menu
								function closeSidebarMenu() {
									sidebar.classList.add('-translate-x-full');
									overlay.classList.add('hidden');
									document.body.style.overflow = '';
								}

								// Événements
								if (menuToggle) {
									menuToggle.addEventListener('click', openSidebar);
								}

								if (closeSidebar) {
									closeSidebar.addEventListener('click', closeSidebarMenu);
								}

								if (overlay) {
									overlay.addEventListener('click', closeSidebarMenu);
								}

								// Fermer le menu sur les liens de navigation (mobile)
								const navLinks = sidebar.querySelectorAll('a');
								navLinks.forEach(link => {
									link.addEventListener('click', () => {
										if (window.innerWidth < 1024) {
											closeSidebarMenu();
										}
									});
								});
							});
						</script>
	</body>
</html>
